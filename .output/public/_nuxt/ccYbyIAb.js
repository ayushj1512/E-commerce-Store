import{_ as T,G as O,r as g,c as a,o as r,C as f,a as s,U as v,V as x,z as l,t as u,F as P,E as N,ab as V}from"#entry";import{u as E}from"./Xk0yAe1G.js";const S={class:"min-h-screen flex flex-col justify-center items-center p-4 bg-white"},j={key:0,class:"w-full max-w-sm text-center"},B={class:"flex items-center border border-gray-400 rounded-lg overflow-hidden mb-4 shadow-sm"},U=["disabled"],C={key:0,class:"mt-2 text-red-500 text-sm"},D={key:1,class:"w-full max-w-sm text-center"},F={class:"text-gray-700 mb-4"},I={class:"flex justify-center space-x-3 mb-4"},K=["onUpdate:modelValue","onInput","onKeydown"],W=["disabled"],A={key:0,class:"mt-2 text-red-500 text-sm"},L={key:2,class:"text-center"},M={class:"text-3xl font-bold mb-2 text-black"},R={__name:"index",setup(Y){const t=E(),h=O(),d=g(1),n=g(["","","",""]),c=g(""),i=g(""),y=async()=>{if(!t.mobileNumber||t.mobileNumber.length<10){c.value="Enter a valid 10-digit number";return}c.value="";try{await t.sendLoginOTP(),d.value=2}catch(o){c.value="Failed to send OTP. Try again.",console.error("Send OTP error:",o)}},w=(o,e)=>{e.target.value.length===1&&o<n.value.length-1&&e.target.nextElementSibling.focus()},_=(o,e)=>{!n.value[o]&&e.key==="Backspace"&&o>0&&e.target.previousElementSibling.focus()},k=async()=>{const o=n.value.join("");if(o.length<4){i.value="Enter the full 4-digit OTP";return}i.value="";try{(await t.verifyOtp(o))?.newUser?i.value="New user detected. Registration required.":(d.value=3,setTimeout(()=>h.push("/profile"),1500))}catch(e){i.value="OTP verification failed. Try again.",console.error("OTP verify error:",e)}};return(o,e)=>(r(),a("div",S,[d.value===1?(r(),a("div",j,[e[2]||(e[2]=s("h1",{class:"text-3xl font-bold mb-2 text-black"},"Welcome Back!",-1)),e[3]||(e[3]=s("p",{class:"text-gray-700 mb-6"},"You're just a step away from your favorite clothes ",-1)),s("div",B,[e[1]||(e[1]=s("span",{class:"px-3 text-black font-semibold"},"+91",-1)),v(s("input",{"onUpdate:modelValue":e[0]||(e[0]=p=>l(t).mobileNumber=p),type:"tel",maxlength:"10",placeholder:"Enter mobile number",class:"w-full p-4 focus:outline-none text-black text-lg"},null,512),[[x,l(t).mobileNumber]])]),s("button",{class:"w-full p-3 bg-black text-white rounded-lg hover:bg-gray-800 transition font-semibold shadow-md",onClick:y,disabled:l(t).loading||!l(t).mobileNumber||l(t).mobileNumber.length<10},u(l(t).loading?"Sending OTP...":"Send OTP"),9,U),c.value?(r(),a("p",C,u(c.value),1)):f("",!0)])):f("",!0),d.value===2?(r(),a("div",D,[e[4]||(e[4]=s("h2",{class:"text-2xl font-bold mb-2 text-black"},"Almost There!",-1)),s("p",F,"We sent a 4-digit OTP to "+u(l(t).mobileNumber),1),s("div",I,[(r(!0),a(P,null,N(n.value,(p,m)=>v((r(),a("input",{key:m,"onUpdate:modelValue":b=>n.value[m]=b,type:"text",maxlength:"1",class:"w-16 h-16 text-center border border-gray-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-black text-2xl font-bold shadow-sm",onInput:b=>w(m,b),onKeydown:V(b=>_(m,b),["backspace"])},null,40,K)),[[x,n.value[m]]])),128))]),s("button",{class:"w-full p-3 bg-black text-white rounded-lg hover:bg-gray-800 transition font-semibold shadow-md",onClick:k,disabled:l(t).loading||n.value.join("").length<4},u(l(t).loading?"Verifying...":"Verify OTP"),9,W),i.value?(r(),a("p",A,u(i.value),1)):f("",!0)])):f("",!0),d.value===3?(r(),a("div",L,[s("h2",M,"Welcome, "+u(l(t).name)+"!",1),e[5]||(e[5]=s("p",{class:"text-gray-700 mb-4"},"You're all set to grab your favorite clothes ",-1)),e[6]||(e[6]=s("div",{class:"w-20 h-20 mx-auto border-4 border-black rounded-full animate-ping mt-4"},null,-1))])):f("",!0)]))}},G=T(R,[["__scopeId","data-v-522fbff6"]]);export{G as default};
