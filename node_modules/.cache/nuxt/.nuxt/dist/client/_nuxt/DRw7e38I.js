import{af as V,r as u,g as f,B as A,p as E,c as o,o as r,a as l,C,J as P,b as k,z as p,t as D,F as N,E as S,w as H,N as J,al as T}from"#entry";import{u as G}from"./BT-RHb3s.js";import{F as M}from"./Dh9xxezy.js";import{P as j}from"./BacioKtk.js";const q={class:"bg-white text-black min-h-screen p-4 md:p-8"},K={class:"flex flex-col md:flex-row gap-6"},Q={class:"md:w-1/5 flex-shrink-0"},W={class:"p-4 sm:p-6 flex flex-col h-full md:h-auto"},X={class:"flex-1"},Y={key:0,class:"text-center py-10"},Z={key:1,class:"text-center py-10 text-red-600"},ee={key:2},ae={class:"flex flex-wrap gap-2 mb-4 overflow-x-auto"},te=["onClick"],se={key:0,class:"text-center py-10 text-gray-500"},de={__name:"index",setup(re){const n=G(),d=V(),c=u(!1),g=u([]),i=u({min:null,max:null}),m=u("default"),$=[{label:"Price: Low to High",value:"lowtohigh"},{label:"Price: High to Low",value:"hightolow"},{label:"Newest",value:"latest"},{label:"Trending",value:"trending"},{label:"Rating",value:"rating"}],F=u([]),h=e=>e?.toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""),w=f(()=>{const t=(d.params.child||"").match(/(\d+)$/);return t?t[1]:d.params.parent}),z=f(()=>n.getProductsByCategory(w.value)),x=f(()=>z.value.map((e,t)=>{const a=e.rawData?.product_data?JSON.parse(e.rawData.product_data):{},s=a[0]||{},v=a.images||[],U=v[0]?.img||e.images[0]?.img||"",L=v[1]?.img||v[0]?.img||null,b=s.categories?s.categories.split("^").map(y=>y.split("*")[0]):e.displayCategories||[],O=(a.shoeSize||[]).map(y=>y.Size).filter(Boolean)||(e.product_all_sizes||[]).filter(Boolean)||["N/A"];return{...e,id:e.id||e.product_id||s.id||`product-${t}`,displayName:s.name||e.displayName||"",displayPrice:Number(s.selling_price)||Number(e.displayPrice)||0,displayDiscount:Number(s.discount_price)||Number(e.displayDiscount)||0,displayCategories:b,imageUrl:U,hoverImageUrl:L,categorySlug:h(b[0]||"general"),productSlug:h(s.name||e.displayName||"item"),product_all_sizes:O}}).filter(e=>g.value.length?e.displayCategories.some(t=>g.value.includes(t)):!0).filter(e=>(i.value.min!==null?e.displayPrice>=i.value.min:!0)&&(i.value.max!==null?e.displayPrice<=i.value.max:!0)).sort((e,t)=>{switch(m.value){case"lowtohigh":return e.displayPrice-t.displayPrice;case"hightolow":return t.displayPrice-e.displayPrice;case"latest":return new Date(t.rawData?.date_added)-new Date(e.rawData?.date_added);case"rating":return(t.rawData?.avg_rating??0)-(e.rawData?.avg_rating??0);case"trending":return(t.rawData?.sales??0)-(e.rawData?.sales??0);default:return 0}})),B=e=>m.value=e.value,R=()=>{},I=()=>{g.value=[],i.value={min:null,max:null},m.value="default"},_=async()=>{await n.fetchProducts({categoryId:w.value,page:1,perPage:100})};return A(_),E(()=>[d.params.parent,d.params.child],_),(e,t)=>(r(),o("div",q,[l("div",K,[l("div",Q,[l("button",{onClick:t[0]||(t[0]=a=>c.value=!0),class:"md:hidden mb-4 bg-black text-white px-5 py-2 rounded-full w-full"}," Filters "),c.value?(r(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-40 z-40 md:hidden",onClick:t[1]||(t[1]=a=>c.value=!1)})):C("",!0),l("aside",{class:P([c.value?"translate-x-0":"-translate-x-full","fixed top-0 left-0 h-full w-10/12 sm:w-80 bg-white shadow-2xl z-50 transform transition-transform duration-300 overflow-y-auto","md:relative md:translate-x-0 md:shadow-none md:w-full md:h-auto md:transform-none"])},[l("div",W,[l("button",{class:"md:hidden self-end text-gray-600 text-xl font-bold hover:text-gray-800 mb-4",onClick:t[2]||(t[2]=a=>c.value=!1)}," âœ• "),k(M,{categories:F.value,selectedCategories:g.value,priceRange:i.value,onApplyPrice:R,onClear:I},null,8,["categories","selectedCategories","priceRange"])])],2)]),l("div",X,[p(n).loading?(r(),o("div",Y,"Loading products...")):p(n).error?(r(),o("div",Z,D(p(n).error),1)):(r(),o("div",ee,[l("div",ae,[(r(),o(N,null,S($,a=>l("button",{key:a.value,onClick:s=>B(a),class:P([m.value===a.value?"bg-black text-white scale-105 shadow-md":"bg-gray-100 text-gray-800 hover:bg-gray-200","px-3 py-1 rounded-full border text-sm whitespace-nowrap"])},D(a.label),11,te)),64))]),k(T,{name:"fade-slide",tag:"div",class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},{default:H(()=>[(r(!0),o(N,null,S(x.value,(a,s)=>(r(),J(j,{key:a.id||`product-${s}`,id:a.id||`product-${s}`,title:a.displayName,image:a.imageUrl,hoverImage:a.hoverImageUrl,price:a.displayPrice,mrp:a.displayDiscount,showCartBtn:!0,productUrl:`/${p(d).params.parent||"products"}/${a.categorySlug}/${a.productSlug}/${a.id}`},null,8,["id","title","image","hoverImage","price","mrp","productUrl"]))),128))]),_:1}),x.value.length?C("",!0):(r(),o("div",se," No products found. "))]))])])]))}};export{de as default};
