{"version":3,"file":"index-DwcJBaIo.js","sources":["../../../../../../../pages/login/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen flex flex-col justify-center items-center p-4 bg-white\">\r\n\r\n    <!-- Step 1: Mobile Number Input -->\r\n    <div v-if=\"step === 1\" class=\"w-full max-w-sm text-center\">\r\n      <h1 class=\"text-3xl font-bold mb-2 text-black\">Welcome Back!</h1>\r\n      <p class=\"text-gray-700 mb-6\">You're just a step away from your favorite clothes </p>\r\n\r\n      <div class=\"flex items-center border border-gray-400 rounded-lg overflow-hidden mb-4 shadow-sm\">\r\n        <span class=\"px-3  text-black font-semibold\">+91</span>\r\n        <input\r\n          v-model=\"auth.mobileNumber\"\r\n          type=\"tel\"\r\n          maxlength=\"10\"\r\n          placeholder=\"Enter mobile number\"\r\n          class=\"w-full p-4 focus:outline-none text-black text-lg\"\r\n        />\r\n      </div>\r\n\r\n      <button\r\n        class=\"w-full p-3 bg-black text-white rounded-lg hover:bg-gray-800 transition font-semibold shadow-md\"\r\n        @click=\"sendOTP\"\r\n        :disabled=\"auth.loading || !auth.mobileNumber || auth.mobileNumber.length < 10\"\r\n      >\r\n        {{ auth.loading ? \"Sending OTP...\" : \"Send OTP\" }}\r\n      </button>\r\n\r\n      <p v-if=\"message\" class=\"mt-2 text-red-500 text-sm\">{{ message }}</p>\r\n    </div>\r\n\r\n    <!-- Step 2: OTP Verification -->\r\n    <div v-if=\"step === 2\" class=\"w-full max-w-sm text-center\">\r\n      <h2 class=\"text-2xl font-bold mb-2 text-black\">Almost There!</h2>\r\n      <p class=\"text-gray-700 mb-4\">We sent a 4-digit OTP to {{ auth.mobileNumber }}</p>\r\n\r\n      <!-- OTP Inputs -->\r\n      <div class=\"flex justify-center space-x-3 mb-4\">\r\n        <input\r\n          v-for=\"(digit, index) in otpDigits\"\r\n          :key=\"index\"\r\n          v-model=\"otpDigits[index]\"\r\n          type=\"text\"\r\n          maxlength=\"1\"\r\n          class=\"w-16 h-16 text-center border border-gray-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-black text-2xl font-bold shadow-sm\"\r\n          @input=\"focusNext(index, $event)\"\r\n          @keydown.backspace=\"focusPrev(index, $event)\"\r\n        />\r\n      </div>\r\n\r\n      <button\r\n        class=\"w-full p-3 bg-black text-white rounded-lg hover:bg-gray-800 transition font-semibold shadow-md\"\r\n        @click=\"verifyOTP\"\r\n        :disabled=\"auth.loading || otpDigits.join('').length < 4\"\r\n      >\r\n        {{ auth.loading ? \"Verifying...\" : \"Verify OTP\" }}\r\n      </button>\r\n\r\n      <p v-if=\"otpMessage\" class=\"mt-2 text-red-500 text-sm\">{{ otpMessage }}</p>\r\n    </div>\r\n\r\n    <!-- Step 3: Success -->\r\n    <div v-if=\"step === 3\" class=\"text-center\">\r\n      <h2 class=\"text-3xl font-bold mb-2 text-black\">Welcome, {{ auth.name }}!</h2>\r\n      <p class=\"text-gray-700 mb-4\">You're all set to grab your favorite clothes </p>\r\n      <div class=\"w-20 h-20 mx-auto border-4 border-black rounded-full animate-ping mt-4\"></div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { useAuthStore } from \"~/stores/auth\";\r\n\r\nconst auth = useAuthStore();\r\nconst router = useRouter();\r\n\r\nconst step = ref(1);\r\nconst otpDigits = ref([\"\", \"\", \"\", \"\"]);\r\nconst message = ref(\"\");\r\nconst otpMessage = ref(\"\");\r\n\r\n// Send OTP\r\nconst sendOTP = async () => {\r\n  if (!auth.mobileNumber || auth.mobileNumber.length < 10) {\r\n    message.value = \"Enter a valid 10-digit number\";\r\n    return;\r\n  }\r\n  message.value = \"\";\r\n  try {\r\n    await auth.sendLoginOTP();\r\n    step.value = 2;\r\n  } catch (err) {\r\n    message.value = \"Failed to send OTP. Try again.\";\r\n    console.error(\"Send OTP error:\", err);\r\n  }\r\n};\r\n\r\n// Focus next OTP input\r\nconst focusNext = (index, event) => {\r\n  if (event.target.value.length === 1 && index < otpDigits.value.length - 1) {\r\n    event.target.nextElementSibling.focus();\r\n  }\r\n};\r\n\r\n// Focus previous on backspace\r\nconst focusPrev = (index, event) => {\r\n  if (!otpDigits.value[index] && event.key === \"Backspace\" && index > 0) {\r\n    event.target.previousElementSibling.focus();\r\n  }\r\n};\r\n\r\n// Verify OTP\r\nconst verifyOTP = async () => {\r\n  const otp = otpDigits.value.join(\"\");\r\n  if (otp.length < 4) {\r\n    otpMessage.value = \"Enter the full 4-digit OTP\";\r\n    return;\r\n  }\r\n  otpMessage.value = \"\";\r\n  try {\r\n    const res = await auth.verifyOtp(otp);\r\n    if (res?.newUser) {\r\n      otpMessage.value = \"New user detected. Registration required.\";\r\n    } else {\r\n      step.value = 3;\r\n      setTimeout(() => router.push(\"/profile\"), 1500);\r\n    }\r\n  } catch (err) {\r\n    otpMessage.value = \"OTP verification failed. Try again.\";\r\n    console.error(\"OTP verify error:\", err);\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\ninput:focus {\r\n  transition: all 0.2s ease-in-out;\r\n  box-shadow: 0 0 0 2px rgba(0,0,0,0.2);\r\n}\r\nbutton:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n</style>\r\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_unref","_ssrInterpolate","index","_ssrIncludeBooleanAttr"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AA2EA,UAAM,OAAO,aAAY;AACV,cAAS;AAExB,UAAM,OAAO,IAAI,CAAC;AAClB,UAAM,YAAY,IAAI,CAAC,IAAI,IAAI,IAAI,EAAE,CAAC;AACtC,UAAM,UAAU,IAAI,EAAE;AACtB,UAAM,aAAa,IAAI,EAAE;;AAhFlB,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,yEAAqE,MAAA,CAAA,CAAA,mBAAA;UAGnE,KAAA,UAAI,GAAA;gcAOAC,cAAA,SAAAC,MAAA,IAAA,EAAK,YAAY,oRAWjBA,MAAA,IAAA,EAAK,WAAO,CAAKA,MAAA,IAAA,EAAK,gBAAgBA,MAAA,IAAA,EAAK,aAAa,SAAM,EAAA,IAAA,cAAA,sBAEtEC,eAAAD,MAAA,IAAA,EAAK,UAAO,mBAAA,UAAA;YAGR,QAAA,OAAO;uFAAuC,QAAA,KAAO,CAAA,MAAA;AAAA;;;;;;;UAIrD,KAAA,UAAI,GAAA;AAE6C,cAAA,oNAAAC,eAAAD,MAAA,IAAA,EAAK,YAAY,CAAA,8EAAA;sBAK9C,UAAA,OAAS,CAA1B,OAAOE,WAAK;AAEX,gBAAA,SAAAH,cAAA,SAAA,UAAA,MAAUG,MAAK,CAAA,CAAA,2LAAA;AAAA;6IAYfC,sBAAAH,MAAA,IAAA,EAAK,WAAW,gBAAU,SAAS,SAAM,CAAA,IAAA,cAAA,sBAEjDC,eAAAD,MAAA,IAAA,EAAK,UAAO,iBAAA,YAAA;YAGR,WAAA,OAAU;uFAAuC,WAAA,KAAU,CAAA,MAAA;AAAA;;;;;;;UAI3D,KAAA,UAAI,GAAA;AAC8C,cAAA,oHAAAC,eAAAD,MAAA,IAAA,EAAK,IAAI,CAAA,2NAAA;AAAA;;;;;;;;;;;;;;"}