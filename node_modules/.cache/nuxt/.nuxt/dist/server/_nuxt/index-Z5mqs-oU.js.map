{"version":3,"file":"index-Z5mqs-oU.js","sources":["../../../../../../../pages/[parent]/[child]/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg-white text-black min-h-screen p-4 md:p-8\">\r\n    <div class=\"flex flex-col md:flex-row gap-6\">\r\n      <!-- Sidebar -->\r\n      <div class=\"md:w-1/5 flex-shrink-0\">\r\n        <!-- Mobile toggle button -->\r\n        <button \r\n          @click=\"isFilterOpen = true\" \r\n          class=\"md:hidden mb-4 bg-black text-white px-5 py-2 rounded-full w-full\"\r\n        >\r\n          Filters\r\n        </button>\r\n\r\n        <!-- Mobile overlay -->\r\n        <div \r\n          v-if=\"isFilterOpen\" \r\n          class=\"fixed inset-0 bg-black bg-opacity-40 z-40 md:hidden\"\r\n          @click=\"isFilterOpen = false\"\r\n        ></div>\r\n\r\n        <!-- Sidebar -->\r\n        <aside \r\n          :class=\"[\r\n            isFilterOpen ? 'translate-x-0' : '-translate-x-full',\r\n            'fixed top-0 left-0 h-full w-10/12 sm:w-80 bg-white shadow-2xl z-50 transform transition-transform duration-300 overflow-y-auto',\r\n            'md:relative md:translate-x-0 md:shadow-none md:w-full md:h-auto md:transform-none'\r\n          ]\"\r\n        >\r\n          <div class=\"p-4 sm:p-6 flex flex-col h-full md:h-auto\">\r\n            <!-- Close button for mobile -->\r\n            <button \r\n              class=\"md:hidden self-end text-gray-600 text-xl font-bold hover:text-gray-800 mb-4\"\r\n              @click=\"isFilterOpen = false\"\r\n            >\r\n              âœ•\r\n            </button>\r\n\r\n            <!-- Filter Sidebar Component -->\r\n            <FilterSidebar \r\n              :categories=\"categories\" \r\n              :selectedCategories=\"selectedCategories\" \r\n              :priceRange=\"priceRange\"\r\n              @applyPrice=\"applyPriceFilter\" \r\n              @clear=\"clearFilters\" \r\n            />\r\n          </div>\r\n        </aside>\r\n      </div>\r\n\r\n      <!-- Products Grid -->\r\n      <div class=\"flex-1\">\r\n        <div v-if=\"store.loading\" class=\"text-center py-10\">Loading products...</div>\r\n        <div v-else-if=\"store.error\" class=\"text-center py-10 text-red-600\">{{ store.error }}</div>\r\n        <div v-else>\r\n          <!-- Sorting -->\r\n          <div class=\"flex flex-wrap gap-2 mb-4 overflow-x-auto\">\r\n            <button \r\n              v-for=\"option in sortOptions\" \r\n              :key=\"option.value\" \r\n              @click=\"applySort(option)\"\r\n              :class=\"[\r\n                selectedSort === option.value \r\n                  ? 'bg-black text-white scale-105 shadow-md' \r\n                  : 'bg-gray-100 text-gray-800 hover:bg-gray-200', \r\n                'px-3 py-1 rounded-full border text-sm whitespace-nowrap'\r\n              ]\"\r\n            >\r\n              {{ option.label }}\r\n            </button>\r\n          </div>\r\n\r\n          <!-- Products Grid -->\r\n          <transition-group \r\n            name=\"fade-slide\" \r\n            tag=\"div\"\r\n            class=\"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\"\r\n          >\r\n            <ProductCard \r\n              v-for=\"(product, index) in filteredProducts\" \r\n              :key=\"product.id || `product-${index}`\"\r\n              :id=\"product.id || `product-${index}`\" \r\n              :title=\"product.displayName\" \r\n              :image=\"product.imageUrl\"\r\n              :hoverImage=\"product.hoverImageUrl\" \r\n              :price=\"product.displayPrice\" \r\n              :mrp=\"product.displayDiscount\"\r\n              :showCartBtn=\"true\"\r\n              :productUrl=\"`/${route.params.parent || 'products'}/${product.categorySlug}/${product.productSlug}/${product.id}`\" \r\n            />\r\n          </transition-group>\r\n\r\n          <div v-if=\"!filteredProducts.length\" class=\"text-center py-10 text-gray-500\">\r\n            No products found.\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, watch } from \"vue\";\r\nimport { useRoute } from \"#app\";\r\nimport { useProductStore } from \"@/stores/productStore.js\";\r\nimport FilterSidebar from \"@/components/collection/FilterSidebar.vue\";\r\nimport ProductCard from \"@/components/common/ProductCard.vue\";\r\n\r\nconst store = useProductStore();\r\nconst route = useRoute();\r\n\r\n// UI State\r\nconst isFilterOpen = ref(false);\r\nconst selectedCategories = ref([]);\r\nconst priceRange = ref({ min: null, max: null });\r\nconst selectedSort = ref(\"default\");\r\n\r\n// Sorting options\r\nconst sortOptions = [\r\n  { label: \"Price: Low to High\", value: \"lowtohigh\" },\r\n  { label: \"Price: High to Low\", value: \"hightolow\" },\r\n  { label: \"Newest\", value: \"latest\" },\r\n  { label: \"Trending\", value: \"trending\" },\r\n  { label: \"Rating\", value: \"rating\" },\r\n];\r\n\r\n// Categories (dynamic)\r\nconst categories = ref([]);\r\n\r\n// Slugify Helper\r\nconst slugify = (text) =>\r\n  text?.toString().toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/(^-|-$)+/g, \"\");\r\n\r\n// --- Products for current route/category ---\r\nconst categoryIdFromRoute = computed(() => {\r\n  const subCategoryParam = route.params.child || \"\";\r\n  const match = subCategoryParam.match(/(\\d+)$/);\r\n  return match ? match[1] : route.params.parent;\r\n});\r\n\r\nconst productsForCategory = computed(() =>\r\n  store.getProductsByCategory(categoryIdFromRoute.value)\r\n);\r\n\r\n// Filtered products\r\nconst filteredProducts = computed(() => {\r\n  return productsForCategory.value\r\n    .map((p, index) => {\r\n      const parsedData = p.rawData?.product_data ? JSON.parse(p.rawData.product_data) : {};\r\n      const firstData = parsedData[\"0\"] || {};\r\n\r\n      const images = parsedData.images || [];\r\n      const imageUrl = images[0]?.img || p.images[0]?.img || \"\";\r\n      const hoverImageUrl = images[1]?.img || images[0]?.img || null;\r\n\r\n      const categoriesFromData = firstData.categories\r\n        ? firstData.categories.split(\"^\").map((c) => c.split(\"*\")[0])\r\n        : p.displayCategories || [];\r\n\r\n      const allSizes =\r\n        (parsedData.shoeSize || []).map((s) => s.Size).filter(Boolean) ||\r\n        (p.product_all_sizes || []).filter(Boolean) ||\r\n        [\"N/A\"];\r\n\r\n      return {\r\n        ...p,\r\n        id: p.id || p.product_id || firstData.id || `product-${index}`,\r\n        displayName: firstData.name || p.displayName || \"\",\r\n        displayPrice: Number(firstData.selling_price) || Number(p.displayPrice) || 0,\r\n        displayDiscount: Number(firstData.discount_price) || Number(p.displayDiscount) || 0,\r\n        displayCategories: categoriesFromData,\r\n        imageUrl,\r\n        hoverImageUrl,\r\n        categorySlug: slugify(categoriesFromData[0] || \"general\"),\r\n        productSlug: slugify(firstData.name || p.displayName || \"item\"),\r\n        product_all_sizes: allSizes,\r\n      };\r\n    })\r\n    .filter((p) =>\r\n      selectedCategories.value.length\r\n        ? p.displayCategories.some((cat) => selectedCategories.value.includes(cat))\r\n        : true\r\n    )\r\n    .filter((p) =>\r\n      (priceRange.value.min !== null ? p.displayPrice >= priceRange.value.min : true) &&\r\n      (priceRange.value.max !== null ? p.displayPrice <= priceRange.value.max : true)\r\n    )\r\n    .sort((a, b) => {\r\n      switch (selectedSort.value) {\r\n        case \"lowtohigh\": return a.displayPrice - b.displayPrice;\r\n        case \"hightolow\": return b.displayPrice - a.displayPrice;\r\n        case \"latest\": return (new Date(b.rawData?.date_added)) - (new Date(a.rawData?.date_added));\r\n        case \"rating\": return (b.rawData?.avg_rating ?? 0) - (a.rawData?.avg_rating ?? 0);\r\n        case \"trending\": return (b.rawData?.sales ?? 0) - (a.rawData?.sales ?? 0);\r\n        default: return 0;\r\n      }\r\n    });\r\n});\r\n\r\nconst applySort = (option) => (selectedSort.value = option.value);\r\n\r\nconst applyPriceFilter = () => {};\r\nconst clearFilters = () => {\r\n  selectedCategories.value = [];\r\n  priceRange.value = { min: null, max: null };\r\n  selectedSort.value = \"default\";\r\n};\r\n\r\n// --- Fetch products for route/category ---\r\nconst fetchProductsFromRoute = async () => {\r\n  await store.fetchProducts({\r\n    categoryId: categoryIdFromRoute.value,\r\n    page: 1,\r\n    perPage: 100,\r\n  });\r\n};\r\n\r\nonMounted(fetchProductsFromRoute);\r\nwatch(() => [route.params.parent, route.params.child], fetchProductsFromRoute);\r\n</script>\r\n\r\n<style>\r\n.fade-slide-enter-active,\r\n.fade-slide-leave-active {\r\n  transition: all 0.5s ease;\r\n}\r\n\r\n.fade-slide-enter-from,\r\n.fade-slide-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(-10px);\r\n}\r\n\r\n.fade-slide-enter-to,\r\n.fade-slide-leave-from {\r\n  opacity: 1;\r\n  transform: translateY(0);\r\n}\r\n</style>\r\n"],"names":["_ssrRenderAttrs","_mergeProps","_unref","_ssrInterpolate","_ssrRenderList"],"mappings":"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"}