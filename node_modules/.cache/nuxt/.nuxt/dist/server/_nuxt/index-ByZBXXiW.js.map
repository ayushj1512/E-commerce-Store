{"version":3,"file":"index-ByZBXXiW.js","sources":["../../../../../../../pages/[parent]/[child]/[product]/[id]/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg-white text-black min-h-screen font-sans p-4 md:p-10\">\r\n    <!-- Loading Shimmer -->\r\n    <div v-if=\"loading\" class=\"space-y-6\">\r\n      <div class=\"w-full h-[450px] bg-gray-200 rounded-xl animate-pulse\"></div>\r\n      <div class=\"flex gap-4 overflow-x-auto\">\r\n        <div v-for=\"n in 6\" :key=\"n\" class=\"h-40 w-40 bg-gray-200 rounded-lg animate-pulse flex-shrink-0\"></div>\r\n      </div>\r\n      <div class=\"space-y-4 max-w-md\">\r\n        <div class=\"h-8 bg-gray-200 rounded w-3/4 animate-pulse\"></div>\r\n        <div class=\"h-6 bg-gray-200 rounded w-1/2 animate-pulse\"></div>\r\n        <div class=\"h-6 bg-gray-200 rounded w-full animate-pulse\"></div>\r\n        <div class=\"flex gap-4\">\r\n          <div class=\"h-10 bg-gray-200 rounded flex-1 animate-pulse\"></div>\r\n          <div class=\"h-10 bg-gray-200 rounded flex-1 animate-pulse\"></div>\r\n        </div>\r\n        <div class=\"h-4 bg-gray-200 rounded w-full animate-pulse\"></div>\r\n        <div class=\"h-4 bg-gray-200 rounded w-full animate-pulse\"></div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Error State -->\r\n    <div v-else-if=\"error\" class=\"text-center py-20 text-red-500\">{{ error }}</div>\r\n\r\n    <!-- Product Content -->\r\n    <div v-else class=\"flex flex-col md:flex-row gap-12\">\r\n      <!-- Left Images -->\r\n      <div class=\"md:w-1/2 flex flex-col gap-4\">\r\n        <div class=\"w-full rounded-xl flex items-center justify-center p-4 h-[450px] bg-gray-50 transition\">\r\n          <img :src=\"selectedImage\" alt=\"Selected Product\" class=\"rounded-lg w-full h-full object-contain\" loading=\"lazy\"/>\r\n        </div>\r\n\r\n        <div v-if=\"product.images.length > 1\" class=\"flex gap-4 overflow-x-auto w-full mt-4\">\r\n          <div\r\n            v-for=\"(img, index) in product.images\"\r\n            :key=\"index\"\r\n            @click=\"selectImage(index)\"\r\n            :class=\"['bg-gray-50 rounded-xl flex items-center justify-center p-2 cursor-pointer transition transform hover:scale-105 flex-shrink-0 border-2', selectedIndex === index ? 'border-black' : 'border-gray-200']\"\r\n            style=\"width: 140px; height: 140px;\"\r\n          >\r\n            <img :src=\"img.img\" alt=\"Thumb\" class=\"rounded-lg w-full h-full object-contain\" loading=\"lazy\"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Product Info -->\r\n      <div class=\"md:w-1/2 flex flex-col justify-between gap-6\">\r\n        <div>\r\n          <h1 class=\"text-3xl md:text-4xl font-bold tracking-tight\">{{ product.name }}</h1>\r\n\r\n          <div class=\"flex items-baseline gap-4 mt-2\">\r\n            <p class=\"text-2xl font-semibold\">‚Çπ{{ product.selling_price }}</p>\r\n            <p v-if=\"product.discount_price > 0\" class=\"text-base line-through text-gray-500\">\r\n              ‚Çπ{{ (parseFloat(product.selling_price) + parseFloat(product.discount_price)).toFixed(2) }}\r\n            </p>\r\n          </div>\r\n\r\n          <!-- Available Sizes Label -->\r\n          <div class=\"mt-4\">\r\n            <h3 class=\"font-semibold mb-2 text-sm\">Available Sizes:</h3>\r\n\r\n            <!-- Show size buttons if sizes exist -->\r\n            <div v-if=\"product.product_all_sizes?.length\" class=\"flex flex-wrap gap-2\">\r\n              <button\r\n                v-for=\"(size, idx) in product.product_all_sizes\"\r\n                :key=\"idx\"\r\n                @click=\"selectedSize = size\"\r\n                :class=\"['px-3 py-1 border rounded-full text-sm transition hover:scale-105', selectedSize === size ? 'bg-black text-white border-black' : 'bg-white text-black border-gray-300']\"\r\n              >{{ size }}</button>\r\n            </div>\r\n\r\n            <!-- Show note if no sizes -->\r\n            <p v-else class=\"text-gray-500 text-sm\">No size selection required</p>\r\n          </div>\r\n\r\n          <p v-if=\"product.description_short\" class=\"text-gray-600 leading-relaxed mt-3\">{{ product.description_short }}</p>\r\n\r\n          <div class=\"flex flex-col sm:flex-row gap-4 mt-6 sticky top-24 z-10\">\r\n            <button \r\n              @click=\"buyNow\"\r\n              class=\"flex-1 bg-black text-white py-3 px-6 rounded-full font-semibold hover:bg-gray-800 transform hover:scale-105 transition\">\r\n              Buy Now\r\n            </button>\r\n            <button \r\n              @click=\"addToCart\"\r\n              class=\"flex-1 border-2 border-black text-black py-3 px-6 rounded-full font-semibold hover:bg-black hover:text-white transform hover:scale-105 transition\">\r\n              Add to Cart\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Delivery & Returns -->\r\n        <div class=\"space-y-4 mt-6\">\r\n          <div class=\"pt-4 border-t border-gray-200\">\r\n            <h3 class=\"font-semibold\">Delivery Information</h3>\r\n            <p class=\"text-gray-600 text-sm leading-relaxed mt-1\">{{ product.delivery_information }}</p>\r\n          </div>\r\n          <div class=\"pt-4 border-t border-gray-200\">\r\n            <h3 class=\"font-semibold\">Return Information</h3>\r\n            <p class=\"text-gray-600 text-sm leading-relaxed mt-1\" v-html=\"product.return_information\"></p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { ofetch } from \"ofetch\";\r\nimport { useCartStore } from \"@/stores/cartStore\";\r\nimport { useToast } from \"vue-toastification\";\r\n\r\nconst selectedIndex = ref(0);\r\nconst selectedImage = ref(\"\");\r\nconst selectedSize = ref(\"\");\r\nconst product = ref({});\r\nconst loading = ref(true);\r\nconst error = ref(null);\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst cartStore = useCartStore();\r\nconst toast = useToast();\r\n\r\nconst API_URL = \"https://api.streetstylestore.com\";\r\nconst API_KEY = \"Bm23NaocNyDb2qWiT9Mpn4qXdSmq7bqdoLzY6espTB3MC6Rx\";\r\n\r\nasync function fetchProduct() {\r\n  loading.value = true;\r\n  error.value = null;\r\n\r\n  if (history.state?.product) {\r\n    product.value = history.state.product;\r\n    selectedImage.value = product.value.images[0]?.bigImg || \"\";\r\n    selectedSize.value = \"\";\r\n    loading.value = false;\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const productId = route.params.id;\r\n    const res = await ofetch(`${API_URL}/collections/products/documents/${productId}`, {\r\n      headers: { \"x-typesense-api-key\": API_KEY },\r\n    });\r\n    const doc = res.document ?? res;\r\n    const parsed = doc.product_data ? JSON.parse(doc.product_data) : {};\r\n    const firstData = parsed[\"0\"] || {};\r\n\r\n    product.value = {\r\n      ...doc,\r\n      name: doc.name || firstData.name || \"\",\r\n      selling_price: doc.real_selling_price ?? doc.selling_price ?? parseFloat(firstData.selling_price) ?? 0,\r\n      discount_price: doc.discount_price ?? parseFloat(firstData.discount_price) ?? 0,\r\n      description_short: firstData.description_short || doc.description_short || \"\",\r\n      images: parsed.images || [],\r\n      product_all_sizes: doc.product_all_sizes || [],\r\n      delivery_information: parsed.delivery_information || doc.delivery_information || \"\",\r\n      return_information: parsed.return_information || doc.return_information || \"\",\r\n    };\r\n\r\n    selectedImage.value = product.value.images[0]?.bigImg || \"\";\r\n    selectedSize.value = \"\";\r\n  } catch (err) {\r\n    console.error(err);\r\n    error.value = \"Failed to fetch product data.\";\r\n    toast?.error(error.value, { timeout: 2500, icon: \"‚ùå\" });\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nfunction selectImage(index) {\r\n  selectedIndex.value = index;\r\n  selectedImage.value = product.value.images[index].bigImg;\r\n}\r\n\r\nfunction addToCart() {\r\n  // If product has sizes, require selection\r\n  if (product.value.product_all_sizes?.length && !selectedSize.value) {\r\n    toast?.warning(\"Please select a size before adding to cart\", { timeout: 2000, icon: \"‚ö†Ô∏è\" });\r\n    return;\r\n  }\r\n\r\n  if (product.value.id) {\r\n    cartStore.addToCart({\r\n      id: product.value.id,\r\n      name: product.value.name,\r\n      price: parseFloat(product.value.selling_price),\r\n      size: selectedSize.value || null,\r\n      image: selectedImage.value,\r\n      quantity: 1\r\n    });\r\n\r\n    toast?.success(`${product.value.name} has been added to your cart`, {\r\n      timeout: 2000,\r\n      icon: \"üõí\",\r\n    });\r\n  } else {\r\n    toast?.error(\"Cannot add product to cart\", { timeout: 2000, icon: \"‚ùå\" });\r\n  }\r\n}\r\n\r\nfunction buyNow() {\r\n  addToCart();\r\n  router.push(\"/cart\");\r\n}\r\n\r\nonMounted(fetchProduct);\r\n</script>\r\n\r\n<style>\r\n.fade-enter-active, .fade-leave-active { transition: all 0.3s ease; }\r\n.fade-enter-from, .fade-leave-to { opacity: 0; max-height: 0; }\r\n</style>\r\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrRenderAttr","_ssrRenderClass","_ssrInterpolate"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAkHA,UAAM,gBAAgB,IAAI,CAAC;AAC3B,UAAM,gBAAgB,IAAI,EAAE;AAC5B,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,UAAU,IAAI,EAAE;AACtB,UAAM,UAAU,IAAI,IAAI;AACxB,UAAM,QAAQ,IAAI,IAAI;AAER,aAAA;AACC,cAAA;AACG,iBAAA;AACJ,aAAA;;AA3HP,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,4DAAwD,MAAA,CAAA,CAAA,GAAA;UAEtD,QAAA,OAAO;;AAGGC,sBAAA,IAAL,MAAC;;;;iBAgBD,MAAA,OAAK;4EAA4C,MAAA,KAAK,CAAA,QAAA;AAAA;AAO1D,cAAA,mMAAAC,cAAA,OAAK,cAAA,KAAa,CAAA,+FAAA;YAGf,QAAA,MAAQ,OAAO,SAAM,GAAA;;AAELD,wBAAA,QAAA,MAAQ,QAAM,CAA7B,KAAK,UAAK;iCAGgIE,eAAA,CAAA,yIAAA,cAAA,UAAkB,QAAK,iBAAA,iBAAA,CAAA,4BACzK,EAAA,SAAA,SAAA,UAAA,QAAA,CAAoC,wBAE9B,OAAK,IAAI,GAAG;;;;;;gJAQyCC,eAAA,QAAA,MAAQ,IAAI,wFAGjCA,eAAA,QAAA,MAAQ,aAAa;AAClD,YAAA,QAAA,MAAQ,iBAAc,GAAA;qFACxB,WAAW,QAAA,MAAQ,aAAa,IAAI,WAAW,QAAA,MAAQ,cAAc,GAAG,QAAO,CAAA,CAAA,CAAA,MAAA;AAAA;;;;YAS3E,QAAA,MAAQ,mBAAmB,QAAM;;AAElBH,wBAAA,QAAA,MAAQ,mBAAiB,CAAvC,MAAM,QAAG;oCAG4DE,eAAA,CAAA,oEAAA,aAAA,UAAiB,OAAI,qCAAA,qCAAA,CAAA,qBAChG,IAAI;;;;;;;AAOH,YAAA,QAAA,MAAQ,mBAAiB;AAAgD,gBAAA,iDAAAC,eAAA,QAAA,MAAQ,iBAAiB,CAAA,MAAA;AAAA;;;mmBAoBhDA,eAAA,QAAA,MAAQ,oBAAoB,gKAIvB,QAAA,MAAQ,sBAAkB;;;;;;;;;;;;"}